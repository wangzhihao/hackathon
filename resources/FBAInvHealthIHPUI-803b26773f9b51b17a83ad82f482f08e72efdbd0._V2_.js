(function(z){var v=window.AmazonUIPageJS||window.P,B=v._namespace||v.attributeErrors,d=B?B("FBAInvHealthIHPUI"):v;d.guardFatal?d.guardFatal(z)(d,window):d.execute(function(){z(d,window)})})(function(z,v,B){z.when("A","ihp-table-base","match-lowest-price-handler","parent-row-select-handler","get-product-detail-page-handler","create-removal-order-handler","advertise-listing-handler","edit-listing-handler","improve-keywords-handler","create-a-sale-handler","layout-adjustment-handler","a-modal","overstock-preference-handler",
"report-download-handler","navigation-redirect-handler","show-all-marketplaces-handler","message-handler","icp-modal-handler-factory","get-msku-central-handler","tabela-table-overstock","ready").register("ihp-overstock-table",function(d,a,b,c,e,f,g,h,k,l,m,n,p,q,r,t,u,v,y){return a.extend({init:function(a,d){new u("overstock","ICP-Excess-Inventory#Excess-Inventory");new b("overstock","ICP-Excess-Inventory#Excess-Inventory",d);new c("overstock","ICP-Excess-Inventory#Excess-Inventory");new e("overstock",
"ICP-Excess-Inventory#Excess-Inventory");new f("overstock","ICP-Excess-Inventory#Excess-Inventory","/inventoryplanning/excess-inventory");new g("overstock","ICP-Excess-Inventory#Excess-Inventory");new h("overstock","ICP-Excess-Inventory#Excess-Inventory",a);new k("overstock","ICP-Excess-Inventory#Excess-Inventory",a);new l("overstock","ICP-Excess-Inventory#Excess-Inventory",a);new m("overstock");new p(n);new q("overstock","ICP-Excess-Inventory#Excess-Inventory","/gp/ssof/reports/search.html#orderAscending=&recordType=ExcessInventory");
new r("Overstock");new t("overstock","ICP-Excess-Inventory#Excess-Inventory");new v("overstock","ICP-Excess-Inventory#Excess-Inventory");new y("overstock","ICP-Excess-Inventory#Excess-Inventory")}})});z.when("A","Class").register("ihp-table-base",function(d,a){return a.extend({init:function(){}})});z.when("A","Class").register("base-preference-handler",function(d,a){var b=d.$;return a.extend({_save_endpoint:B,_preference_group:B,init:function(a,e,f){this._save_endpoint=a;this._preference_group=e;
var g=this,h=f.get(b("#PreferenceDeclar"));h.update({"min-width":350});d.declarative("cancelSavePreferene","click",function(){h.hide()});d.declarative("confirmSavePreference","click",function(){g.savePreference()});d.on("preference-save-succeed",function(){g.onPreferenceSaved()})},savePreference:function(){var a=this,b=this.getPreferenceData();b.preferenceGroup=a._preference_group;a.shadowIn();d.post(a._save_endpoint,{params:b,success:function(b){b.succeeded?d.trigger("preference-save-succeed"):(a.shadowOut(),
a.warnError())},error:function(){a.shadowOut();a.warnError()}})},shadowIn:function(){b("#preference_loading_overlay").show()},shadowOut:function(){b("#preference_loading_overlay").hide()},warnError:function(){b("#saveStatus").show()},getPreferenceData:function(){},onPreferenceSaved:function(){}})});z.when("A","Class","base-preference-handler").register("overstock-preference-handler",function(d,a,b){var c=d.$;return b.extend({init:function(a){this._super("/inventoryplanning/preference/savePreferences",
"overstock",a)},onPreferenceSaved:function(){v.location.reload()},getPreferenceData:function(){return{ShowLowestPrice:c("#ShowLowestPrice").is(":checked"),ShowBuyBoxPrice:c("#ShowBuyBoxPrice").is(":checked"),ShowMaxDesiredDaysOfSupply:c("#ShowMaxDesiredDaysOfSupply").is(":checked")}}})});z.when("A","Class","base-preference-handler").register("inventoryage-preference-handler",function(d,a,b){var c=d.$;return b.extend({init:function(a){this._super("/inventoryplanning/preference/savePreferences","inventoryage",
a)},onPreferenceSaved:function(){v.location.reload()},getPreferenceData:function(){return{ShowLowestPrice:c("#ShowLowestPrice").is(":checked"),ShowBuyBoxPrice:c("#ShowBuyBoxPrice").is(":checked"),ShowMaxDesiredDaysOfSupply:c("#ShowMaxDesiredDaysOfSupply").is(":checked")}}})});z.when("A","ihp-table-base","match-lowest-price-handler","get-product-detail-page-handler","create-removal-order-handler","advertise-listing-handler","edit-listing-handler","improve-keywords-handler","create-a-sale-handler",
"layout-adjustment-handler","a-modal","inventoryage-preference-handler","report-download-handler","navigation-redirect-handler","message-handler","icp-modal-handler-factory","get-msku-central-handler","tabela-table-inventoryaged","ready").register("ihp-inventoryage-table",function(d,a,b,c,e,f,g,h,k,l,m,n,p,q,r,t,u){return a.extend({init:function(a,d){new r("inventoryaged","ICP-Inventory-Age#Inventory-Age");new b("inventoryaged","ICP-Inventory-Age#Inventory-Age",d);new c("inventoryaged","ICP-Inventory-Age#Inventory-Age");
new e("inventoryaged","ICP-Inventory-Age#Inventory-Age","/inventoryplanning/inventory-age");new f("inventoryaged","ICP-Inventory-Age#Inventory-Age");new g("inventoryaged","ICP-Inventory-Age#Inventory-Age",a);new h("inventoryaged","ICP-Inventory-Age#Inventory-Age",a);new k("inventoryaged","ICP-Inventory-Age#Inventory-Age",a);new l("inventoryaged");new n(m);new p("inventoryaged","ICP-Inventory-Age#Inventory-Age","/gp/ssof/reports/search.html#orderAscending=&recordType=INVENTORY_AGE");new q("InventoryAge");
new t("inventoryaged","ICP-Inventory-Age#Inventory-Age");new u("inventoryaged","ICP-Inventory-Age#Inventory-Age")}})});z.when("A","Class","tabela-manager").register("layout-adjustment-handler",function(d,a,b){var c=d.$;return a.extend({init:function(a){this.adjustFloatingColumnWidth(a);c("#a-page").addClass(a+"-page")},adjustFloatingColumnWidth:function(a){var d=b.get(a)._controllers.record.handlers["floating-bar"];d.setWidths=function(){var a=c("#floatingHeaderColumns");c(".floatingHeaderBar");var b=
c("#mt-floating-bar"),e=c("#head-row"),l=e.offset().left,m=e.outerWidth();b.css({width:m,left:l});a.find("th").each(function(){var a=this.id.substring(0,this.id.length-9);c(this).css("width",c("#"+a).outerWidth())});a.width(e.width());d.updateTableHeaders()};d.setWidths()}})});z.when("A","Class","icp-action-handler","action-utility","a-modal","ready").register("advertise-listing-handler",function(d,a,b,c,e){return b.extend({init:function(a,b){this._super(a,b);var h=this;d.on("advertise-listings",
function(a){h.log_action("advertiseListing-bulk",h.wrapActionData(a));h.advertiseListing(a)});d.on("advertise-listing",function(a){h.log_action("advertiseListing-single",h.wrapActionData([a.recordId]));h.advertiseListing([a.recordId])});d.declarative("cancel-ad-cross-mk-switch","click",function(a){e.get(d.$("#adListingsModalDeclarative-"+h.tableName)).hide()});d.declarative("ad-cross-mk-switch","click",function(a){c.redirect_to(a.data.url,!1,"ICP-Excess-Inventory#Excess-Inventory#"+a.data.operation+
"-switch-marketplace")});v.dismissAdvertiseListingFrame=function(){$(".a-popover.a-popover-modal .a-button-close.a-declarative").click()}},advertiseListing:function(a){var b=this,c="",k="",l=!1,m=e.get(d.$("#adListingsModalDeclarative-"+b.tableName));d.each(a,function(a){a=b.getRecordData(a);var e=d.$("#currentMarketplaceId").val();a.MarketplaceID===e?c+="skuList="+encodeURIComponent(a.SKU)+"&":(k=a.EMarketplaceID,l=!0)});if(l){a=1;var n=d.$("#"+b.tableName)[0].getElementsByClassName("mt-current-page");
0!==n.length&&(a=n[0].value);m.update({url:"/inventoryplanning/excess-inventory/ad-cross-marketplace-popover?targetMK="+k+"&pageNum="+a+"&operation=advertiseListing",header:d.$("#adCrossMarketplacePopoverTitle").val()})}else m.update({url:"/hz/cm/sku/advertise?"+c,header:""});d.$("a#adListingsModalTrigger-"+b.tableName).click()}})});z.when("A","Class","icp-action-handler").register("base-edit-listing-handler",function(d,a,b){return b.extend({catalogURL:B,replaceMarketplaceRegex:/marketplaceID=.*$/,
init:function(a,b,d){this._super(a,b);this.catalogURL=d},editListing:function(a,b){var d=this.getRecordData(a),g=null,h=null;if(d&&d.SKU&&d.ASIN){var g=encodeURIComponent(d.SKU),h=encodeURIComponent(d.ASIN),k=this.catalogURL;d.EMarketplaceID&&(k=k.replace(this.replaceMarketplaceRegex,"marketplaceID="+d.EMarketplaceID));k=k+"&asin="+h+"&sku="+g;b&&(k+=b);this.redirect_to(k,!0,!0,this.wrapActionData([a]))}else console.log("Wrong asin or sku",a)}})});z.when("A","Class","base-edit-listing-handler").register("create-a-sale-handler",
function(d,a,b){var c=d.$;return b.extend({init:function(a,b,g){this._super(a,b,g);var h=this,k=c("#isAggregatedMarketplace").val();d.on("create-a-sale",function(a){"true"===k?setTimeout(function(){c("#"+a.recordId+"-your-price-combined-field")[0].getElementsByTagName("input")[0].focus()},200):h.editListing(a.recordId,"#offer");h.log_action(null,h.wrapActionData([a.recordId]))})},getActionName:function(){return"createASale"}})});z.when("A","Class","icp-action-handler").register("create-removal-order-handler",
function(d,a,b){return b.extend({tableURL:B,init:function(a,b,f){this._super(a,b);this.tableURL=f;var g=this;d.on("createremovalorder",function(a){g.log_action("createRemovalOrder-bulk",g.wrapActionData(a));g.createRemovalOrders(a)});d.on("create-removal-order",function(a){g.log_action("createRemovalOrder-single",g.wrapActionData([a.recordId]));g.createRemovalOrders([a.recordId])})},createRemovalOrders:function(a){var b=this,f={};a=d.reduce(a,function(a,c,d){(c=b.getRecordData(c))&&c.SKU&&c.SupportedActions&&
-1!==c.SupportedActions.indexOf("RemovalOrder")&&f[c.FNSKU]===B&&(a["mSku."+a.count]=c.SKU,a["asin."+a.count]=c.ASIN,a["fnSku."+a.count]=c.FNSKU,a.count+=1,f[c.FNSKU]=!0);return a},{count:0});0<a.count&&(delete a.count,this.performPostRequest(a,"/gp/basic-fulfillment/v2/start-removal.html",b.tableURL))}})});z.when("A","Class","a-modal","base-edit-listing-handler").register("edit-listing-handler",function(d,a,b,c){return c.extend({init:function(a,b,c){this._super(a,b,c);var h=this;d.on("edit-listing",
function(a){h.myEditListing(a.recordId,"#offer")})},myEditListing:function(a,c){var g=this.getRecordData(a),h=d.$("#currentMarketplaceId").val(),k=b.get(d.$("#adListingsModalDeclarative-"+this.tableName));if(g.MarketplaceID===h)this.editListing(a,c);else{this.log_action("editListing",this.wrapActionData([a]));var g=g.EMarketplaceID,h=1,l=d.$("#"+this.tableName)[0].getElementsByClassName("mt-current-page");0!==l.length&&(h=l[0].value);k.update({url:"/inventoryplanning/excess-inventory/ad-cross-marketplace-popover?targetMK="+
g+"&pageNum="+h+"&operation=editListing",header:d.$("#adCrossMarketplacePopoverTitle").val()});d.$("a#adListingsModalTrigger-"+this.tableName).click()}},getActionName:function(){return"editListing"}})});z.when("A","Class","icp-action-handler").register("get-product-detail-page-handler",function(d,a,b){return b.extend({init:function(a,b){this._super(a,b);var f=this;d.declarative("get-product-detail-page","click",function(a){f.redirect_to(a.data.url,!0,!0,f.wrapActionData([a.data.recordId]))})},getActionName:function(){return"getToDetailPage"}})});
z.when("A","Class","icp-action-handler").register("get-msku-central-handler",function(d,a,b){return b.extend({init:function(a,b){this._super(a,b);var f=this;d.declarative("get-msku-central","click",function(a){f.redirect_to(a.data.url,!0,!0,f.wrapActionData([a.data.recordId]))})},getActionName:function(){return"getMSKUCentral"}})});z.when("A","Class","action-utility","ready").register("navigation-redirect-handler",function(d,a,b){return a.extend({init:function(a){d.declarative("icp-navigation","click",
function(d){b.redirect_to(d.data.url,d.data.target,a+"-ICP-Navigation#"+d.data.tabId+"#click")})}})});z.when("A","Class","JSON","tabela-manager").register("icp-action-handler",function(d,a,b,c){var e=d.$;return a.extend({tableName:B,$ele:B,tabelaTable:B,actionPrefix:B,init:function(a,b){this.tableName=a;this.$ele=e("#"+a);this.tabelaTable=c.get(a);this.actionPrefix=b?b:a;"function"!==typeof String.prototype.endsWith&&(String.prototype.endsWith=function(a){return-1!==this.indexOf(a,this.length-a.length)});
"function"!==typeof Array.prototype.contains&&(Array.prototype.contains=function(a){for(var b in this)if(this[b]===a)return!0;return!1})},performPostRequest:function(a,b,c){var k=e("<form />").attr({action:b,method:"post",target:"_blank"});c&&k.append(e("<input />").attr({type:"hidden",name:"cancelURL",value:c}));d.each(a,function(a,b){var c=e("<input>");c.attr({type:"hidden",name:b,value:a});k.append(c)});e("body").append(k);k.submit()},getRecordData:function(a){return a?(a=this.tabelaTable.getViewModel(a))?
a.getRowData():a:null},log_action:function(a,c){a||(a=this.getActionName());if(a){var h="/inventoryplanning/actions/"+encodeURIComponent(this.actionPrefix+"#"+a);c?e.ajax({type:"POST",url:h,contentType:"application/json",dataType:"html",data:b.stringify(c)}):d.get(h)}},redirect_to:function(a,b,c,d){a&&(c&&this.log_action(null,d),b?v.open(a,"_blank"):v.location.href=a)},wrapActionData:function(a){return d.map(a,function(a){function b(a){return"undefined"===typeof e(n).attr(a)?!1:!0}function c(a){a=
e(n).attr(a);0<a.indexOf("SELLER_GROUP")&&(d["seller-group"]=a.substring(a.indexOf(":",a.indexOf("SELLER_GROUP"))+3,a.indexOf(",",a.indexOf("SELLER_GROUP"))-2))}var d={recordId:a},f=e("td#"+a+"-SupportedActions .mt-save-button-dropdown-normal select option:checked").attr("data-action-string");f&&(d["suggested-action"]=f);var n="td#"+a+"-select-field .a-declarative";b("data-overstock-row-select-changed")?c("data-overstock-row-select-changed"):b("data-inventoryaged-row-select-changed")&&c("data-inventoryaged-row-select-changed");
return d})},getActionName:function(){}})});z.when("A","Class","a-modal","ready").register("message-handler",function(d,a,b){var c="waiting",e=!1;a=a.extend({_check_unread_message_endpoint:"/inventoryplanning/check-unread-message",init:function(a,b){var c=this;e||(e=!0,c._bindEvents(),c.checkUnreadMessage(function(a){c.showMessage(a)}))},_bindEvents:function(){d.declarative("continue-oih-new-feature-notification","click",function(a){d.$("#icp-modal-inventory-settings").click()})},checkUnreadMessage:function(a){d.get(this._check_unread_message_endpoint,
{success:function(b){b.hasMessage?(a({messageUrl:b.messageUrl}),c="msg_found"):c="no_msg"}})},showMessage:function(a){b.get(d.$("#messageModalDeclarative")).update({url:a.messageUrl});d.$("a#messageModalTrigger").click()}});a.execIfNoMessage=function(a){var b=d.interval(function(){"no_msg"===c&&a();"waiting"!==c&&v.clearInterval(b)},200)};return a});z.when("A","icp-modal-handler","ready").register("icp-modal-create-removal-handler",function(d,a,b){return a.extend({validInput:!0,init:function(a,b,
f,g,h){this._super(a,b,f,g,h);var k=this;d.declarative("icp-modal-create-removal","click",function(a){k.createRemovalOrders(k.currentRecordId)&&k.modalDialog.hide();this.validInput||k.showError(["RecommendRemovalQuantity"])})},createRemovalOrders:function(a){a=this.getRecordData(a);var b=d.$("#input-quantity").val();if(!this.validateInput(b))return this.validInput=!1;var f=this.getCreateRemovalParams(a,b);this.log_action("icp-modal-jump-to-SC-removal",[this.warpRemovalActionData(this.currentRecordId,
a.RecommendRemovalQuantity,b)]);this.performPostRequest(f,"/gp/basic-fulfillment/v2/create-order.html",this.tableURL);return!0},getCreateRemovalParams:function(a,b){var d={};a&&a.SKU&&a.SupportedActions&&-1!==a.SupportedActions.indexOf("RemovalOrder")&&(d.fulfillmentMethod="REMOVAL",d["merchantSku.0"]=a.SKU,d["asin.0"]=a.ASIN,d["fulfillmentNetworkSku.0"]=a.FNSKU,d["sellables.0"]=b);return d},validateInput:function(a){return 0===a.length?!1:/^[0-9]+$/.test(a)?!0:!1},warpRemovalActionData:function(a,
b,d){a={recordId:a};a["input-quantity"]=d;a["recommended-quantity"]=b;a["action-name"]="create-removal-oih";return a}})});z.when("A","icp-action-handler","a-modal","ready").register("icp-modal-handler",function(d,a,b){return a.extend({getURL:B,saveURL:B,modalDialog:B,title:B,attrArray:[],logAttrArray:[],currentRecordId:B,init:function(a,e,f,g,h,k){this._super(a,e);var l=d.$;this.getURL="/inventoryplanning/modal/"+f+"/get?";this.saveURL="/inventoryplanning/modal/"+f+"/save";this.modalDialog=b.get(l("#icp-modal"));
this.title=g;this.attrArray=h;this.logAttrArray=k;var m="icp-modal-save-"+f,n=this;n.initClickBind("icp-modal-"+f);l("#icp-modal-form-"+f).on("submit",function(a){a.preventDefault();var b=l(this).serializeArray();a=l(".icp-modal-input-date input");d.each(a,function(a){var c={};c.name=a.id;c.value=a.value;b.push(c)});a=JSON.stringify(b);n.startLoading();n.log_action(m,[n.convertForm2Map(this)]);l.ajax({type:"POST",url:n.saveURL,contentType:"application/json",dataType:"json",data:a}).done(function(a){n.stopLoading();
a.status?n.showSuccess(a.saveInputs):n.showError(a.errorInputs)}).fail(function(){n.stopLoading()})})},initClickBind:function(a){var b=this;d.declarative(a,"click",function(d){b.log_action(a,[{actionName:"click Inventory Settings Entry Link"}]);b.openModal(null)});d.on(a,function(d){var g=d.recordId;b.currentRecordId=g;g!==B&&b.log_action(a,b.wrapActionData([d.recordId]));b.openModal(g)});d.declarative("icp-modal-cancel","click",function(a){b.modalDialog.hide()});d.declarative("icp-modal-close","click",
function(a){b.modalDialog.hide()});d.declarative("icp-modal-inventory-settings-input","click",function(a){d.$(".icp-modal-inv-settings-save-desc").hide();d.$(".icp-modal-inv-settings-closebtn").hide();d.$(".icp-modal-inv-settings-save-buttons").show()})},convertForm2Map:function(a){a=d.$(a).serializeArray();var b={};d.each(a,function(a){b[a.name]=a.value});a=d.$(".icp-modal-input-date input");d.each(a,function(a){b[a.id]=a.value});if(this.logAttrArray!==B&&0!==this.logAttrArray.length){var f=this.getRecordData(this.currentRecordId);
d.each(this.logAttrArray,function(a){b[a]=f[a]})}return b},openModal:function(a){var b=this.getURL;if(this.attrArray!==B&&0!==this.attrArray.length){var f=this.getRecordData(a),g=!0;d.each(this.attrArray,function(a){f.hasOwnProperty(a)&&null!==f[a]&&(g?g=!1:b+="&",b+=a+"="+encodeURIComponent(f[a]))})}this.modalDialog.update({url:b,header:this.title,"min-width":500});this.modalDialog.show()},startLoading:function(){d.$(".icp-modal-loading-hide").hide();d.$(".icp-modal-loading-show").show()},stopLoading:function(){d.$(".icp-modal-loading-hide").show();
d.$(".icp-modal-loading-show").hide()},showSuccess:function(a){d.$(".icp-modal-success-hide").hide();d.$(".icp-modal-success-show").show();d.$(".icp-modal-input").removeClass("a-form-error");if(a!==B){var b=this.getRecordData(this.currentRecordId);d.each(a,function(a,c){b[c]=a})}},showError:function(a){d.$(".icp-modal-failed-hide").hide();d.$(".icp-modal-failed-show").show();d.$(".icp-modal-input").removeClass("a-form-error");d.$(".icp-modal-alert").hide();d.each(a,function(a){d.$(".icp-modal-input-"+
a).addClass("a-form-error");d.$(".icp-modal-input-date #"+a).addClass("a-form-error");d.$(".icp-modal-alert-"+a).show()})}})});z.when("A","Class","icp-modal-handler","icp-modal-create-removal-handler").register("icp-modal-handler-factory",function(d,a,b,c){return a.extend({init:function(a,b){this.initUpdateAssumption(a,b);this.initCreateSale(a,b);this.initCreateRemoval(a,b);this.initInventorySettings(a,b)},initUpdateAssumption:function(a,c){var g=d.$("#icp-modal-update-assumption-title").text();new b(a,
c,"update-assumption",g,"SKU ASIN ProductName EMarketplaceID RecoveryRate UnitCost UpdateAssumptionLastUpdate".split(" "))},initCreateSale:function(a,c){var g=d.$("#icp-modal-create-sale-title").text();new b(a,c,"create-sale",g,"SKU ASIN ProductName EMarketplaceID HealthyQuantity RecommendSalePrice RecommendSaleStartDate RecommendSaleEndDate Price SalePrice".split(" "),["SalePrice","Price"])},initCreateRemoval:function(a,b){var g=d.$("#icp-modal-create-removal-title").text();new c(a,b,"create-removal",
g,"ASIN SKU ProductName EMarketplaceID RecommendRemovalQuantity DeltaNPV TotalQuantity".split(" "))},initInventorySettings:function(a,c){var g=d.$("#icp-modal-inventory-settings-title").text();new b(a,c,"inventory-settings",g,[])}})});z.when("A","Class","base-edit-listing-handler").register("improve-keywords-handler",function(d,a,b){return b.extend({init:function(a,b,f){this._super(a,b,f);var g=this;d.on("improve-keywords",function(a){g.editListing(a.recordId,"#tang_keywords")})},getActionName:function(){return"improveKeywords"}})});
z.when("A","Class","icp-action-handler").register("match-lowest-price-handler",function(d,a,b){return b.extend({init:function(a,b,f){this._super(a,b);this.maxFractionDigits=f;var g=this;d.declarative("match-lowest-price","click",function(a){g.log_action("matchLowestPrice-single",g.wrapActionData([a.data.recordId]));g.matchLowestPrice(a.data.recordId,g.maxFractionDigits)});d.on("match-price",function(a){g.log_action("matchLowestPrice-bulk",g.wrapActionData(a));d.each(a,function(a){g.matchLowestPrice(a,
g.maxFractionDigits)})})},matchLowestPrice:function(a,b){var d="4 5 44551 123311 35691 101611".split(" "),g=this.getLandedLowestPrice(a);if(null===g)return null;var h=this.getLandedYourPirce(a);if(null===h||h>g){h=this.getYourPriceShippingCharge(a);null!==h&&(g-=h);if(0>=g)return null;h=this.tabelaTable.getViewModel(a,"your-price-combined-field");if(h!==B&&null!==h.$element){var h=h.$element.find("div[data-column='your-price-field'] input"),k=this.getCurrencyString(g,b),l=this.getRecordData(a);if(!l)return null;
d.contains(l.MarketplaceID)&&(k=k.replace(".",","));h.val(k).trigger("change")}return g}return null},convertCurrency:function(a){return null===a||a===B?null:Math.round(100*Number(a))},getCurrencyString:function(a,b){return null===a?"":(a/100).toFixed(b)},getLandedLowestPrice:function(a){a=this.getMatchLowestPriceData(a);if(null===a||a.price===B)return null;try{var b=this.convertCurrency(a.price),d=0;if(null===b)return null;a.shippingCharge!==B&&(d=this.convertCurrency(a.shippingCharge));return b+
d}catch(g){return console.warn("Error to convert lowest price or lowest price shipping charge: "+a.price+", "+a.shippingCharge,g),null}},getLandedYourPirce:function(a){var b=this.getYourPrice(a);return null===b?null:(a=this.getYourPriceShippingCharge(a))?b+a:b},getYourPrice:function(a){a=this.getRecordData(a);if(!a)return null;try{return this.convertCurrency(a.Price)}catch(b){return console.warn(a.ShippingCharge+" is not valid ShippingCharge: ",b),null}},getYourPriceShippingCharge:function(a){a=this.getRecordData(a);
if(!a)return null;try{return this.convertCurrency(a.ShippingCharge)}catch(b){return console.warn(a.ShippingCharge+" is not valid ShippingCharge",b),null}},getMatchLowestPriceElement:function(a){return this.$ele.find("div[data-row='"+a+"'] span[data-action='match-lowest-price']")},getMatchLowestPriceData:function(a){a=this.getMatchLowestPriceElement(a);if(0>=a.size())return null;a=a.data("match-lowest-price");return a===B?null:a}})});z.when("A","Class","icp-action-handler").register("report-download-handler",
function(d,a,b){return b.extend({init:function(a,b,f){this._super(a,b);var g=this;d.declarative("download-report","click",function(){g.redirect_to(f,!0,!0)})},getActionName:function(){return"downloadReport"}})});z.when("A","Class","icp-action-handler").register("show-all-marketplaces-handler",function(d,a,b){return b.extend({init:function(a,b){this._super(a,b);var f={ShowAllMarketplaces:!1,preferenceGroup:"aggregatedoverstock"},g={ShowAllMarketplaces:!0,preferenceGroup:"aggregatedoverstock"};d.declarative("show-signed-in-marketplace",
"click",function(){d.post("/inventoryplanning/preference/savePreferences",{params:f,success:function(a){v.location.href=v.location.pathname}})});d.declarative("show-all-marketplaces","click",function(){d.post("/inventoryplanning/preference/savePreferences",{params:g,success:function(a){v.location.href=v.location.pathname}})})},getActionName:function(){return"showAllMarketplaces"}})});z.when("A","Class","icp-action-handler").register("parent-row-select-handler",function(d,a,b){var c=d.$;return b.extend({childRowSelectsMap:{},
parentRowSelectMap:{},child2ParentMap:{},init:function(a,b){this._super(a,b);var g=c("#"+a)[0].getElementsByClassName("mt-row-select"),h,k,l=this;d.each(g,function(a){a=a.getElementsByTagName("input")[0];var b=a.value;l.isParentRecord(b)?(k=b,h=[],l.parentRowSelectMap[k]=a,l.childRowSelectsMap[k]=h):l.isChildRecord(b)&&(l.child2ParentMap[b]=k,h.push(a))});d.declarative(a+"-row-select-changed","click",function(a){return l.handleEvent.call(l,a)})},getActionName:function(){return"parentRowSelect"},isParentRecord:function(a){return a.endsWith("-parentRow")},
isChildRecord:function(a){return a.endsWith("-childRow")},handleEvent:function(a){a=a.$target[0];var b=a.value;if(this.isParentRecord(b)){var c=a.checked;d.each(this.childRowSelectsMap[b],function(a){a.checked=c})}else this.isChildRecord(b)&&(b=this.child2ParentMap[b],a.checked?d.reduce(this.childRowSelectsMap[b],function(a,b){return a&&b.checked},!0)&&(this.parentRowSelectMap[b].checked=!0):this.parentRowSelectMap[b].checked=!1)}})});z.when("A","Class","a-modal","navigation-redirect-handler","message-handler",
"ready").register("icp-dashboard",function(d,a,b,c,e){var f=d.$;b=a.extend({widgets:B,$ele:B,notificationWidget:B,init:function(a){this.$ele=f(a);this.widgets=this.findWidgets();var b=this;d.each(this.widgets,function(a){"icp-notifications"===a.id&&4<a.getElementsByTagName("tr").length&&(b.notificationWidget=a)});new e},find:function(a){return this.$ele.find(a)},findWidgets:function(){return this.find(".ipd-col > div")}});var g=b.extend({init:function(a){this._super(a)}}),h=b.extend({init:function(a){this._super(a)}});
return a.extend({$ele:B,kpiRow:B,widgetRows:B,init:function(a,b){new c(b);this.$ele=f("#"+a);var e=this.find(".ipd-row");this.kpiRow=new g(e[0]);this.widgetRows=d.map(e.slice(1),function(a){return new h(a)});var n=this;d.on.resize(function(){n.adjustHeight()});this.adjustHeight()},find:function(a){return this.$ele.find(a)},adjustHeight:function(){this.adjustKpisHeight();this.adjustWidgetsHeight()},adjustWidgetsHeight:function(){if(this.widgetRows){var a=this;d.each(a.widgetRows,function(b){a.resetWidgetsUnderLine(b.widgets,
b.notificationWidget);a.resetHeight(b.widgets);a.needAlignWidgetsHeight(b.widgets)&&(a.adjustNotificationTableHeight(b.widgets,b.notificationWidget),a.alignWidgetsHeight(b.widgets),a.alignWidgetsUnderLine(b.widgets,b.notificationWidget))})}},adjustKpisHeight:function(){if(this.kpiRow)if(this.resetHeight(this.kpiRow.widgets),this.needAlignWidgetsHeight(this.kpiRow.widgets))this.alignWidgetsHeight(this.kpiRow.widgets);else{var a=this.kpiRow.widgets.slice(0,2);this.needAlignWidgetsHeight(a)&&this.alignWidgetsHeight(a);
a=this.kpiRow.widgets.slice(2,4);this.needAlignWidgetsHeight(a)&&this.alignWidgetsHeight(a)}},resetHeight:function(a){a.css("height","auto")},needAlignWidgetsHeight:function(a){if(1<a.length){var b=f(v).width();if(d.reduce(a,function(a,b){return a+f(b).outerWidth()},0)<=b)return!0}return!1},alignWidgetsHeight:function(a){if(1<a.length){var b=Math.max.apply(null,d.map(a,function(a){return f(a).outerHeight()}));a.height(b)}},adjustNotificationTableHeight:function(a,b){if(1<a.length&&b!==B){var c=b.getElementsByTagName("tr").length;
if(5<c){var e=b.getElementsByClassName("icp-notifications-table-div")[0],g=Math.max.apply(null,d.map(a,function(a){if(a!==b)return a=a.getElementsByTagName("table")[0],f(a).outerHeight();f(e).css("height","auto");return 5*f(e).outerHeight()/c}));f(e).height(g)}}},resetWidgetsUnderLine:function(a,b){d.each(a,function(a){a!==b&&(a=a.getElementsByClassName("icp-dashboard-widget-foot"),f(a).css({marginTop:"0px"}))})},alignWidgetsUnderLine:function(a,b){d.each(a,function(a){if(a!==b){var c=a.getElementsByClassName("icp-dashboard-widget-foot");
if(0<c.length){var d=f(a).outerHeight(),e=f(c).offset().top;a=f(a).offset().top;d-=e-a;e=f(c).css("margin-top");d=(d-43+parseInt(e,10)).toString()+"px";f(c).css({marginTop:d})}}})}})});z.when("A","a-modal","3p-bs-tour","ready").execute(function(d,a){var b=d.$;if(b("#icp-dashboard-header").length){var c=[{element:"#ipd-kpi-row",title:b("#tour-step1-title").val(),content:b("#tour-step1-content").val(),placement:"top"},{element:"#icp-excess-inventory",title:b("#tour-step2-title").val(),content:b("#tour-step2-content").val(),
placement:"right"},{element:"#icp-notifications",title:b("#tour-step3-title").val(),content:b("#tour-step3-content").val(),placement:"left"},{element:"#icp-inventory-age",title:b("#tour-step4-title").val(),content:b("#tour-step4-content").val(),placement:"right"}];b("#icp-low-inventory").length?c.push({element:"#icp-low-inventory",title:b("#tour-step5-title").val(),content:b("#tour-step5-content").val(),placement:"left"}):b("#icp-restock").length&&c.push({element:"#icp-restock",title:b("#tour-step5-2-title").val(),
content:b("#tour-step5-2-content").val(),placement:"left"});c.push({element:"#icp-dashboard-header",title:b("#tour-step6-title").val(),content:b("#tour-step6-content").val(),placement:"right"});var e=new b.Tour({steps:c,backdrop:!0,storage:!1,debug:!1,stepStringPre:b("#tour-intro-step-pre").val().trim(),stepStringMid:b("#tour-intro-step-mid").val(),template:"<div role='tooltip' class='popover tour-tour a-popover'><div class='arrow'></div><div class='a-popover-header'><button class='a-button-close btn-end' aria-label='Close' data-role='end'><i class='a-icon a-icon-close'></i></button><h4 class='a-popover-header-content popover-title'></h4></div><div class='popover-content-wrapper'><div class='a-popover-content popover-content'></div><div class='popover-navigation'> <div class='popover-pages'></div><div class='btn-group'> <button data-role='prev' class='btn btn-sm btn-default btn-prev'>"+
b("#tour-intro-prev").val()+"</button> <button data-role='next' class='btn  btn-yellow btn-sm btn-default btn-next'>"+b("#tour-intro-next").val()+"</button>  </div> </div> </div></div>"});e.init();b(document).delegate(".tour-tour .btn-next","click",function(){e.next()});b(document).delegate(".tour-tour  .btn-prev","click",function(){e.prev()});b(document).delegate(".tour-tour .btn-end","click",function(){e.end()});b(document).delegate("#tour-trigger-link","click",function(){e.restart()});d.declarative("trigger-producttour-popover",
"click",function(c){a.get(b("#productTourIntroPopoverTrigger")).hide();e.restart()})}});z.when("A","a-modal","3p-bs-tour","ready").execute(function(d,a){var b=d.$;if(b("#excess-inv-header").length){var c=[{element:"#estimated-excess-field",title:b("#tour-step1-title").val(),content:b("#tour-step1-content").val(),placement:"bottom"}];c.push({element:"#days-of-supply-field",title:b("#tour-step4-title").val(),content:b("#tour-step4-content").val(),placement:"top"});b("#est-holding-cost-field").length&&
c.push({element:"#est-holding-cost-field",title:b("#tour-step8-title").val(),content:b("#tour-step8-content").val(),placement:"bottom"});if(b('div[data-column="low-traffic-tag-field"]').length){var e=b('div[data-column="low-traffic-tag-field"]').first().attr("id");e&&c.push({element:"#"+e,title:b("#tour-step2-title").val(),content:b("#tour-step2-content").val(),placement:"left"})}b('div[data-column="low-conversion-tag-field"]').length&&(e=b('div[data-column="low-conversion-tag-field"]').first().attr("id"))&&
c.push({element:"#"+e,title:b("#tour-step3-title").val(),content:b("#tour-step3-content").val(),placement:"left"});e=b("#oihTag").length;b(".mt-save-button-dropdown-normal:first").length&&e&&c.push({element:".mt-save-button-dropdown-normal:first",title:b("#tour-step10-title").val(),content:b("#tour-step10-content").val(),placement:"left"});b("#icp-modal-inventory-settings").length&&c.push({element:"#icp-modal-inventory-settings",title:b("#tour-step9-title").val(),content:b("#tour-step9-content").val(),
placement:"left"});c.push({element:"#excess-inv-header",title:b("#tour-step7-title").val(),content:b("#tour-step7-content").val(),placement:"right"});var f=new b.Tour({steps:c,backdrop:!0,storage:!1,debug:!1,stepStringPre:b("#tour-intro-step-pre").val().trim(),stepStringMid:b("#tour-intro-step-mid").val(),template:"<div role='tooltip' class='popover tour-tour a-popover'><div class='arrow'></div><div class='a-popover-header'><button class='a-button-close btn-end' aria-label='Close' data-role='end'><i class='a-icon a-icon-close'></i></button><h4 class='a-popover-header-content popover-title'></h4></div><div class='popover-content-wrapper'><div class='a-popover-content popover-content'></div><div class='popover-navigation'> <div class='popover-pages'></div><div class='btn-group'> <button data-role='prev' class='btn btn-sm btn-default btn-prev'>"+
b("#tour-intro-prev").val()+"</button> <button data-role='next' class='btn  btn-yellow btn-sm btn-default btn-next'>"+b("#tour-intro-next").val()+"</button>  </div> </div> </div></div>"});f.init();b(document).delegate(".tour-tour .btn-next","click",function(){f.next()});b(document).delegate(".tour-tour  .btn-prev","click",function(){f.prev()});b(document).delegate(".tour-tour .btn-end","click",function(){f.end();b("#oihTag").length&&d.$("#icp-modal-inventory-settings").click()});b(document).delegate("#tour-trigger-link",
"click",function(){f.restart()});d.declarative("trigger-producttour-popover","click",function(c){a.get(b("#productTourIntroPopoverTrigger")).hide();f.restart()})}})});